#!/bin/bash
#
# List installed kernel packages.
#

dpkg-query -W -f '${Status} ${Package} ${Version}\n' 'linux-image-[0-9]*-*' | \
    awk -v cur=$(uname -r) '
        $3 == "installed" {
           package = $4;
           sub("linux-image-", "", package);

           version = $5;
           is_cur = ( package == cur);

           printf("%s %s [%s]\n", (is_cur ? "*" : ""), package, version);
        }'
